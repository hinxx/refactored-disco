<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="simple js -> python">
<meta name="author" content="dodo">
<link rel="icon" href="../../favicon.ico">

<title>Refactored Disco</title>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script>

$.ajaxSetup({ cache:false });

var newFramesObj = {}

$(document).ready(function() {

// to be called from timeout function
function callTest1() {
	console.log("5s timeout expired..");
	
	$.ajax({
		url: "http://localhost:5000/test1/id/1?cnt=123",
			type: 'GET',
			dataType: 'json',
			success: function(res) {
//				 alert(res);
//				console.log(res);
				console.log(typeof res);
//				newFramesObj = JSON.parse(res);
/*
				$("#frames").text("");
        $.each(res, function(index, element) {
            $('#frames').append($('<div>', {
                text: element
            }));
        });
*/
				$("#frames").text(JSON.stringify(res));
			},
			error: function(error) {
				console.log(error);
			}
	});
	
	pull();
}

function pull() {
	console.log("starting 5s timeout..");
	setTimeout(function() { callTest1(); }, 5000);
}

$("#pullbtn").click(function(){
    $("#frames").text("Waiting for data..");
    pull();
});

});


</script>
</head>


<body>
<H1>This is a test page to collect data from python server</H1>
<p>
<p>

<form action="/test1/id/1" method="get">
<input type="submit" value="Submit">
</form>

<hr>

<button id="pullbtn" type="button">Pull!</button>

<div id="frames">
<p>Nothing yet ...
</div>

</body>
</html>
